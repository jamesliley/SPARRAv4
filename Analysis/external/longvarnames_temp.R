## Function to convert machine variable names into long variable names.
##' longvarnames()
##' 
##' Converts machine variable names to long names. Does not do anything clever; add new variables as necessary..
##' @param x variable names
##' @return vector of long form variable names
longvarnames=function(x)
  case_when(
    x=="id"~"Anonymised ID",
    x=="sexM"~"Male sex",
    x=="time"~"Time cutoff",
    x=="cv"~"Fold for cross validation",
    x=="v3score"~"SPARRA version 3 score",
    x=="emergency_bed_days"~"Number of emergency bed days",
    x=="other_bed_days"~"Number of non emergency non elective bed days",
    x=="num_emergency_admissions"~"Number of emergency admissions",
    x=="elective_bed_days"~"Number of elective bed days",
    x=="num_elective_admissions"~"Number of elective admissions",
    x=="num_emergency_selfharm"~"Number of self harm related emergency admissions",
    x=="num_other_admissions"~"Number of non emergency non elective admissions",
    x=="num_alcohol_substance_admissions"~"Number of emergency drug and alcohol related admissions",
    x=="num_alcohol_drug_attendances"~"Number of drug and alcohol related A&E attendances",
    x=="num_psych_attendances"~"Number of psychiatric A&E attendances",
    x=="num_alcohol_admissions"~"Number of emergency alcohol related admissions",
    x=="numLTCs_resulting_in_admin"~"Number of long-term conditions resulting in admission",
    x=="numLTCs_resulting_in_elective_admin"~"Number of long-term conditions resulting in elective admission",
    x=="numLTCs_resulting_in_emergency_admin"~"Number of long-term conditions resulting in emergency admission",
    x=="numLTCs_resulting_in_other_admin"~"Number of long-term conditions resulting in non emergency non elective admission",
    x=="num_bnf_sections"~"Number of BNF sections from which a prescription was filled",
    x=="num_bnf_total"~"Total number of filled prescriptions",
    x=="pis_respiratory"~"Number of respiratory related prescriptions",
    x=="pis_corticosteroids"~"Number of corticosteroid prescriptions",
    x=="pis_antianaemics"~"Number of antianaemic prescriptions",
    x=="pis_cns"~"Number of central nervous system related prescriptions",
    x=="pis_bronco"~"Number of bronchodilator prescriptions",
    x=="pis_infections"~"Number of infection related prescriptions",
    x=="pis_endocrine"~"Number of endocrine related prescriptions",
    x=="pis_incontinence"~"Number of incontinence device presciptions",
    x=="pis_stoma"~"Number of stoma device prescriptions",
    x=="pis_anticoagulant"~"Number of anticoagulant and protamine prescriptions",
    x=="pis_antibacterial"~"Number of antibacterial prescriptions",
    x=="pis_antiepileptic_Drugs"~"Number of antiepileptic prescriptions",
    x=="pis_antifibrinolytic"~"Number of antifibrinolytic and haemostatic prescriptions",
    x=="pis_antisecretory"~"Number of antisecretory and mucosal protectant prescriptions",
    x=="pis_gut_motility"~"Number of antispasmodic and gut-motility altering prescriptions",
    x=="pis_diuretics"~"Number of diuretic prescriptions",
    x=="pis_lipid"~"Number of lipid lowering drug prescriptions",
    x=="pis_bandages"~"Number of arm sling bandage prescriptions",
    x=="pis_catheters"~"Number of catheter prescriptions",
    x=="pis_antiplatelets"~"Number of antiplatelet prescriptions",
    x=="pis_respiratory_corticosteroids"~"Number of respiratory corticosteroid prescriptions",
    x=="pis_dementia"~"Number of dementia related prescriptions",
    x=="pis_skin"~"Number of skin condition prescriptions",
    x=="pis_hypertensive_heart_failure"~"Number of hypertensive heart failure prescriptions",
    x=="pis_intestinal"~"Number of prescriptions for drugs affecting intestinal secretions",
    x=="pis_diabetes"~"Number of prescriptions for drugs used in diabetes mellitus",
    x=="pis_neuromuscular"~"Number of prescriptions for drugs used in neuromuscular disorders",
    x=="pis_parkinsonism"~"Number of prescriptiosn for drugs used in Parkinsonism and related disorders",
    x=="pis_sub_depend"~"Number of prescriptions for drugs used in substance dependence",
    x=="pis_fluids"~"Number of fluid and electrolyte prescriptions",
    x=="pis_Minerals"~"Number of mineral prescriptions",
    x=="pis_mucolytics"~"Number of mucolytic prescriptions",
    x=="pis_nose"~"Number of drugs acting on the nose prescriptions",
    x=="pis_gastro_int"~"Number of gastrointestinal drug prescriptions",
    x=="pis_betablockers"~"Number of beta blocker prescriptions",
    x=="pis_antianginal"~"Number of antianginal prescriptions",
    x=="pis_nutrition"~"Number of oral nutrition prescriptions",
    x=="pis_sex_hormone_antagonists"~"Number of sex hormone antagonists prescriptions",
    x=="pis_genitourinary"~"Number of genitourinary prescriptions",
    x=="pis_inotropic"~"Number of inotropic prescriptions",
    x=="pis_ear"~"Number of ear prescriptions",
    x=="pis_glaucoma"~"Number of glaucoma prescriptions",
    x=="pis_antibacterial_eyes"~"Number of eye antibacterial prescriptions",
    x=="pis_ophthalmic"~"Number of ophthalmic prescriptions",
    x=="pis_antiinflammatory_corticosteroids"~"Number of antiinflammatory corticosteroid prescriptions",
    x=="pis_cromo"~"Number of cromoglycate prescriptions",
    x=="pis_oropharynx"~"Number of oropharyngeal prescriptions",
    x=="pis_antiarrhythmics"~"Number of antiarrhythmic prescriptions",
    x=="pis_immune"~"Number of immunomodulatory prescriptions",
    x=="pis_hosiery"~"Number of hosiery prescriptions",
    x=="pis_cytotoxics"~"Number of cytotoxics prescriptions",
    x=="pis_supplements"~"Number of supplement prescriptions",
    x=="pis_mydriatics"~"Number of mydriatics prescriptions",
    x=="pis_food"~"Number of food prescriptions",
    x=="pis_metabolic"~"Number of metabolic prescriptions",
    x=="pis_local_anaesthetics"~"Number of local anaesthetic prescriptions",
    x=="pis_rheumatic"~"Number of rheumatic disease prescriptions",
    x=="pis_vitamins"~"Number of vitamin prescriptions",
    x=="num_psych_admissions"~"Number of previous psychiatric admissions",
    x=="num_general_ltc"~"Number of recorded long term conditions",
    x=="num_dc_admissions"~"Number of previous day case admissions",
    x=="num_ae2_attendances"~"Number of previous A&E attendances",
    x=="num_outpatient_appointment_general"~"Number of previous first outpatient appointments",
    x=="num_outpatient_appointment_psych"~"Number of previous first psychiatric outpatient appointments",
    x=="num_outpatient_appointment_followup_psych"~"Number of previous followup psychiatric outpatient appointments",
    x=="num_outpatient_appointment_followup_general"~"Number of followup outpatient appointments",
    x=="age"~"Age at time cutoff",
    x=="SIMD_DECILE_2016_SCT"~"SIMD decile",
    x=="parkinsons_indicated"~"Parkinsons disease indicated",
    x=="diabetes_indicated"~"Diabetes indicated",
    x=="MS_indicated"~"Multiple sclerosis indicated",
    x=="epilepsy_indicated"~"Epilepsy indicated",
    x=="dementia_indicated"~"Dementia indicated",    
    x=="days_since_last_AE2"~"Days since last A&E attendance",
    x=="days_since_last_acute"~"Days since last acute admission of any type",
    x=="days_since_last_SMR00"~"Days since last outpatient attendance",
    x=="days_since_last_emergency_admission"~"Days since last emergency admission",
    x=="days_since_last_elective_admission"~"Days since last elective admission",
    x=="days_since_last_SMR04"~"Days since last mental health and day case attedance",
    x=="CONGENITAL_PROBLEMS"~"Previous congenital problems diagnosis",
    x=="ENDOCRINE_MET"~"Previous endocrine or metabolic disease diagnosis",
    x=="DIS_BLOOD"~"Previous blood disease diagnosis",
    x=="ARTHRITIS"~"Previous arthritis diagnosis",
    x=="OTHER_DIGESTIVE"~"Previous digestive disorder diagnosis",
    x=="ASTHMA"~"Previous asthma diagnosis",
    x=="ATRIAL_FIBRILLATION"~"Previous atrial fibrillation diagnosis",
    x=="CANCER"~"Previous cancer diagnosis",
    x=="CHRONIC_LIVER_DISEASE"~"Previous chronic liver disease diagnosis",
    x=="COPD"~"Previous chronic obstructive pulmonary disease diagnosis",
    x=="DEMENTIA"~"Previous dementia diagnosis",
    x=="DIABETES"~"Previous diabetes mellitus diagnosis",
    x=="EPILEPSY"~"Previous epilepsy diagnosis",
    x=="HEART_DISEASE"~"Previous heart disease diagnosis",
    x=="HEART_FAILURE"~"Previous heart failure diagnosis",
    x=="MULTIPLE_SCLEROSIS"~"Previous multiple sclerosis diagnosis",
    x=="PARKINSON_DISEASE"~"Previous Parkinsons disease diagnosis",
    x=="RENAL_FAILURE"~"Previous renal failure diagnosis",
    x=="CEREBROVASCULAR_DISEASE"~"Previous cerebrovascular disease diagnosis",
    x=="ltc_FIRST_ARTHRITIS_EPISODE_yearssincediag"~"Years since first arthritis diagnosis",
    x=="ltc_FIRST_CONGENITAL_PROBLEMS_EPISODE_yearssincediag"~"Years since first congenital problems diagnosis",
    x=="ltc_FIRST_ENDOCRINE_MET_EPISODE_yearssincediag"~"Years since first endocrine or metabolic disease diagnosis",
    x=="ltc_FIRST_DIS_BLOOD_EPISODE_yearssincediag"~"Years since first blood disease diagnosis",
    x=="ltc_FIRST_OTHER_DIGESTIVE_EPISODE_yearssincediag"~"Years since first digestive disorder diagnosis",
    x=="ltc_FIRST_ASTHMA_EPISODE_yearssincediag"~"Years since first asthma diagnosis",
    x=="ltc_FIRST_ATRIAL_FIBRILLATION_EPISODE_yearssincediag"~"Years since first atrial fibrillation diagnosis",
    x=="ltc_FIRST_CANCER_EPISODE_yearssincediag"~"Years since first cancer diagnosis",
    x=="ltc_FIRST_CHRONIC_LIVER_DISEASE_EPISODE_yearssincediag"~"Years since first chronic liver disease diagnosis",
    x=="ltc_FIRST_COPD_EPISODE_yearssincediag"~"Years since first chronic obstructive pulmonary disease diagnosis",
    x=="ltc_FIRST_DEMENTIA_EPISODE_yearssincediag"~"Years since first dementia diagnosis",
    x=="ltc_FIRST_DIABETES_EPISODE_yearssincediag"~"Years since first diabetes mellitus diagnosis",
    x=="ltc_FIRST_EPILEPSY_EPISODE_yearssincediag"~"Years since first epilepsy diagnosis",
    x=="ltc_FIRST_HEART_DISEASE_EPISODE_yearssincediag"~"Years since first heart disease diagnosis",
    x=="ltc_FIRST_HEART_FAILURE_EPISODE_yearssincediag"~"Years since first heart failure diagnosis",
    x=="ltc_FIRST_MULTIPLE_SCLEROSIS_EPISODE_yearssincediag"~"Years since first multiple sclerosis diagnosis",
    x=="ltc_FIRST_PARKINSON_DISEASE_EPISODE_yearssincediag"~"Years since first Parkinsons disease diagnosis",
    x=="ltc_FIRST_RENAL_FAILURE_EPISODE_yearssincediag"~"Years since first renal failure diagnosis",
    x=="ltc_FIRST_CEREBROVASCULAR_DISEASE_EPISODE_yearssincediag"~"Years since first cerebrovascular disease diagnosis",
    x=="ltc_total_count"~"Number of recorded long term conditions",
    x=="target"~"Emergency admission in year following cutoff date",
    x=="reason"~"Whether admitted or died or both"
  )
